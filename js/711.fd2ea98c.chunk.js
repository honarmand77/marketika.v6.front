"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[711],{3583:(e,t,i)=>{i.d(t,{A:()=>n});i(65043);const n=i.p+"static/media/marketika defullt.7ba899dccbc85f4ffaadd4300f6c1069.svg"},20326:(e,t,i)=>{i.d(t,{A:()=>Z});var n=i(89379),r=i(65043),a=i(26240),o=i(54552),s=i(43845),l=i(2828),d=i(78185),c=i(26494),x=i(77739),u=i(17392),h=i(94496),m=i(36591),A=i(30815),g=i(15244),p=i(77466),v=i(51387),j=i(48920),b=i(70141),y=i(99010),f=i(3583),w=i(73216),C=i(33943),k=i(83003),I=i(84589),P=i(40884),q=i(70579);const z=e=>{const t="number"===typeof e?e:parseFloat(e)||0;return new Intl.NumberFormat("fa-IR").format(t)+" \u062a\u0648\u0645\u0627\u0646"},S=e=>{var t,i,S,Z,X,$;let{product:J,loading:K,ClassName:Q}=e;const U=(0,k.wA)(),V=(0,w.Zp)(),ee=(0,a.A)(),te=(0,o.A)(ee.breakpoints.down("sm")),{user:ie,token:ne}=(0,k.d4)((e=>e.auth)),re=(0,k.d4)(P.selectCartItems),ae=(0,k.d4)((e=>e.cart.cartLoadingStates[null===J||void 0===J?void 0:J._id]||!1)),[oe,se]=((0,k.d4)((e=>e.products.loadingStates[null===J||void 0===J?void 0:J._id]||!1)),(0,r.useState)(!1)),[le,de]=(0,r.useState)(!1),[ce,xe]=(0,r.useState)({isInCart:!1,quantity:0,item:null}),ue=(null===J||void 0===J||null===(t=J.likes)||void 0===t?void 0:t.includes(null===ie||void 0===ie?void 0:ie.id))||!1,he=(null===J||void 0===J||null===(i=J.likes)||void 0===i?void 0:i.length)||0,me=parseFloat((null===J||void 0===J||null===(S=J.price)||void 0===S?void 0:S.$numberDecimal)||(null===J||void 0===J?void 0:J.price)||0);(0,r.useEffect)((()=>{const e=re.find((e=>{var t;return(null===e||void 0===e||null===(t=e.product)||void 0===t?void 0:t._id)===(null===J||void 0===J?void 0:J._id)}));xe({isInCart:!!e,quantity:(null===e||void 0===e?void 0:e.quantity)||0,item:e||null})}),[re,null===J||void 0===J?void 0:J._id]);const Ae=(0,r.useCallback)((async e=>{if(e.stopPropagation(),de(!0),ne){try{await U((0,I.GB)({productId:null===J||void 0===J?void 0:J._id,userId:null===ie||void 0===ie?void 0:ie.id,isCurrentlyLiked:ue})).unwrap()}catch(t){console.error("\u062e\u0637\u0627 \u062f\u0631 \u0639\u0645\u0644\u06cc\u0627\u062a \u0644\u0627\u06cc\u06a9:",t)}de(!1)}else V("/auth")}),[null===J||void 0===J?void 0:J._id,null===ie||void 0===ie?void 0:ie.id,ne,V,ue,U]),ge=(0,r.useCallback)((async e=>{if(e.stopPropagation(),e.preventDefault(),!ne)return V("/auth");if(!ae){xe((e=>({isInCart:!0,quantity:e.quantity+1,item:e.item||{_id:"temp-".concat(Date.now()),product:J,quantity:e.quantity+1,priceAtAddition:me}})));try{await U((0,P.addItemToCart)({userId:null===ie||void 0===ie?void 0:ie.id,productId:null===J||void 0===J?void 0:J._id,quantity:1})).unwrap()}catch(t){xe((e=>(0,n.A)((0,n.A)({},e),{},{isInCart:e.quantity>0,quantity:Math.max(0,e.quantity),item:e.quantity>0?e.item:null}))),console.error("\u062e\u0637\u0627 \u062f\u0631 \u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0633\u0628\u062f \u062e\u0631\u06cc\u062f:",t)}}}),[J,null===ie||void 0===ie?void 0:ie.id,ne,V,U,ae,me]),pe=(0,r.useCallback)((async e=>{if(e.stopPropagation(),e.preventDefault(),ne&&!ae){xe((e=>(0,n.A)((0,n.A)({},e),{},{quantity:Math.max(0,e.quantity-1),isInCart:e.quantity>1})));try{await U((0,P.addItemToCart)({userId:null===ie||void 0===ie?void 0:ie.id,productId:null===J||void 0===J?void 0:J._id,quantity:-1})).unwrap()}catch(t){xe((e=>(0,n.A)((0,n.A)({},e),{},{quantity:e.quantity+1,isInCart:!0}))),console.error("\u062e\u0637\u0627 \u062f\u0631 \u06a9\u0627\u0647\u0634 \u062a\u0639\u062f\u0627\u062f \u0645\u062d\u0635\u0648\u0644:",t)}}}),[null===J||void 0===J?void 0:J._id,null===ie||void 0===ie?void 0:ie.id,ne,U,ae]),ve=(0,r.useCallback)((async e=>{if(e.stopPropagation(),e.preventDefault(),ne&&!ae&&ce.item){xe({isInCart:!1,quantity:0,item:null});try{await U((0,P.removeItemFromCart)(ce.item._id)).unwrap()}catch(t){xe({isInCart:!0,quantity:ce.quantity,item:ce.item}),console.error("\u062e\u0637\u0627 \u062f\u0631 \u062d\u0630\u0641 \u0645\u062d\u0635\u0648\u0644:",t)}}}),[ce,U,ae,ne]),je=(0,r.useCallback)((()=>{const e=parseInt((null===J||void 0===J?void 0:J.stock)||0);return e<=0?(0,q.jsx)(s.A,{label:"\u0646\u0627\u0645\u0648\u062c\u0648\u062f",size:"small",color:"error",sx:{mr:1,mb:1}}):e<5?(0,q.jsx)(s.A,{label:"\u062a\u0646\u0647\u0627 ".concat(e," \u0639\u062f\u062f \u0628\u0627\u0642\u06cc \u0645\u0627\u0646\u062f\u0647"),size:"small",color:"warning",sx:{mr:1,mb:1}}):null}),[null===J||void 0===J?void 0:J.stock]),be=(0,r.useCallback)((()=>se(!0)),[]),ye=(0,r.useCallback)((()=>{V("/productPage/".concat(null===J||void 0===J?void 0:J._id))}),[null===J||void 0===J?void 0:J._id,V]);if(K)return(0,q.jsxs)(l.A,{className:"card ".concat(Q),sx:W,children:[(0,q.jsx)(d.A,{variant:"rectangular",height:200}),(0,q.jsxs)(c.A,{children:[(0,q.jsx)(d.A,{variant:"text",width:"60%"}),(0,q.jsx)(d.A,{variant:"text"}),(0,q.jsx)(d.A,{variant:"text",width:"40%"})]})]});const fe=ce.item?ce.item.priceAtAddition*ce.quantity:me*ce.quantity;return(0,q.jsxs)(l.A,{className:"Card ".concat(Q),sx:T,onClick:ye,children:[(0,q.jsx)(x.A,{title:ue?"\u062d\u0630\u0641 \u0627\u0632 \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627":"\u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627",children:(0,q.jsxs)(u.A,{"aria-label":"toggle favorite",onClick:Ae,sx:R,children:[(0,q.jsx)(h.A,{variant:"body2",component:"div",sx:{ml:.5},children:he}),ue?(0,q.jsx)(g.A,{sx:D(le)}):(0,q.jsx)(p.A,{})]})}),(0,q.jsx)(l.A,{className:"img",sx:_,children:(0,q.jsx)(m.A,{component:"img",height:te?"150px":"200px",src:oe?f.A:"".concat(C.T,"/").concat(null===J||void 0===J||null===(Z=J.images)||void 0===Z?void 0:Z[0]),alt:null===J||void 0===J?void 0:J.name,sx:B,onError:be,placeholder:"blur",loading:"lazy"})}),(0,q.jsxs)(c.A,{sx:M,children:[(0,q.jsx)(h.A,{variant:"body2",component:"div",sx:F,children:(null===J||void 0===J?void 0:J.name)||"\u0628\u062f\u0648\u0646 \u0639\u0646\u0648\u0627\u0646"}),(0,q.jsxs)(A.A,{sx:{mt:1},children:[je(),(0,q.jsx)(s.A,{label:"".concat((null===J||void 0===J||null===(X=J.category)||void 0===X?void 0:X.name)||"\u0628\u062f\u0648\u0646 \u062f\u0633\u062a\u0647\u200c\u0628\u0646\u062f\u06cc"),size:"small",sx:{mr:1,mb:1}}),(0,q.jsx)(s.A,{label:"".concat((null===J||void 0===J||null===($=J.subCategory)||void 0===$?void 0:$.name)||"\u0628\u062f\u0648\u0646 \u062f\u0633\u062a\u0647\u200c\u0628\u0646\u062f\u06cc"),size:"small",sx:{mr:1,mb:1}})]}),(0,q.jsxs)(A.A,{sx:E,children:[(0,q.jsx)(h.A,{variant:"body2",sx:L,children:z(me)}),ce.isInCart?(0,q.jsxs)(A.A,{sx:N,children:[(0,q.jsx)(u.A,{"aria-label":"\u062d\u0630\u0641 \u0645\u062d\u0635\u0648\u0644",onClick:ve,disabled:ae,size:"small",sx:O,children:(0,q.jsx)(v.A,{fontSize:"small"})}),(0,q.jsx)(u.A,{"aria-label":"\u06a9\u0627\u0647\u0634 \u062a\u0639\u062f\u0627\u062f",onClick:pe,disabled:ae||ce.quantity<=1,size:"small",sx:O,children:(0,q.jsx)(j.A,{fontSize:"small"})}),(0,q.jsx)(h.A,{variant:"body2",sx:H,children:ce.quantity}),(0,q.jsx)(u.A,{"aria-label":"\u0627\u0641\u0632\u0627\u06cc\u0634 \u062a\u0639\u062f\u0627\u062f",onClick:ge,disabled:ae,size:"small",sx:O,children:(0,q.jsx)(b.A,{fontSize:"small"})})]}):(0,q.jsx)(x.A,{title:"\u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0633\u0628\u062f \u062e\u0631\u06cc\u062f",children:(0,q.jsx)(u.A,{"aria-label":"\u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0633\u0628\u062f \u062e\u0631\u06cc\u062f",onClick:ge,disabled:ae,sx:Y,children:(0,q.jsx)(y.A,{fontSize:"medium",sx:{padding:"2px"}})})}),ce.isInCart&&(0,q.jsx)(h.A,{variant:"body2",sx:G,children:z(fe)})]})]})]})},W={position:"relative",height:400,width:250,borderRadius:"0px"},T={position:"relative",maxHeight:"max-content",boxShadow:"none",padding:"5px",display:"flex",width:{xs:"100%",sm:"250px"},flexDirection:"column",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",background:"#52575D",">:nth-child(3)":{"*":{color:"#fff"}}}},R={position:"absolute",top:1,right:1,zIndex:1,color:"#fff",display:"flex",alignItems:"center",padding:"5px 10px",background:"#52575D",borderRadius:"5px"},D=e=>({transform:e?"scale(1.1)":"scale(1)",transition:".5s ease",color:e?"#ff4081":"inherit"}),_={background:"#fff",borderRadius:"8px"},B={objectFit:"contain",padding:"5px"},M={flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"5px",width:"100%"},F={mb:1,fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical"},E={mt:2,display:"flex",flexDirection:"column"},L={p:1,color:"#52575D",fontWeight:"bold"},N={display:"flex",alignItems:"center",gap:.5,background:"#52575D",borderRadius:"20px",padding:"5px 10px",color:"#fff",alignSelf:"flex-end",m:1},O={color:"#fff",padding:"4px","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},H={minWidth:"20px",textAlign:"center",fontWeight:"bold"},G={alignSelf:"flex-end",fontSize:"0.8rem",color:"#666",mt:.5},Y={p:1,color:"#fff",background:"#52575D",alignSelf:"flex-end","&:hover":{background:"#52575D"},"&:disabled":{background:"#e0e0e0",color:"#9e9e9e"}},Z=(0,r.memo)(S)},38711:(e,t,i)=>{i.r(t),i.d(t,{default:()=>me});var n=i(89379),r=i(65043),a=i(73216),o=i(85381),s=i(30815),l=i(43845),d=i(11906),c=i(26240),x=i(54552),u=i(68903),h=i(78185),m=i(14194),A=i(94496),g=i(16682),p=i(61596),v=i(72040),j=i(17392),b=i(15795),y=i(81637),f=i(77739),w=i(24010),C=i(28739),k=i(40794),I=i(24836),P=i(87332),q=i(69320),z=i(18942),S=i(48920),W=i(70141),T=i(99010),R=i(32279),D=i(25298),_=i(28458),B=i(57525),M=i(53487),F=i(70883),E=i(20326),L=i(15244),N=i(77466),O=i(33943),H=i(70579);const G=e=>{let{product:t,currentImageIndex:i,onImageChange:n,onWishlistToggle:r,wishlisted:a,loadingWishlist:o}=e;return(0,H.jsxs)(s.A,{sx:{position:"relative",borderRadius:"16px",overflow:"hidden"},children:[(0,H.jsx)(f.A,{title:a?"\u062d\u0630\u0641 \u0627\u0632 \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627":"\u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627",children:(0,H.jsx)(j.A,{onClick:r,disabled:o,sx:{position:"absolute",top:8,right:8,zIndex:2,backgroundColor:"rgba(255,255,255,0.9)",boxShadow:1,"&:hover":{backgroundColor:"rgba(255,255,255,1)",transform:"scale(1.1)"}},children:o?(0,H.jsx)(y.A,{size:24}):a?(0,H.jsx)(L.A,{color:"error"}):(0,H.jsx)(N.A,{})})}),(0,H.jsx)(M.P.img,{src:"".concat(O.T,"/").concat(t.images[i]),alt:t.name,style:{width:"100%",height:"auto",objectFit:"contain",cursor:"zoom-in"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),(0,H.jsx)(s.A,{sx:{display:"flex",gap:"8px",mt:2,overflowX:"auto"},children:t.images.map(((e,t)=>(0,H.jsx)(M.P.div,{onClick:()=>n(t),style:{width:"64px",height:"64px",minWidth:"64px",borderRadius:"8px",overflow:"hidden",border:"2px solid ".concat(i===t?"primary.main":"transparent"),cursor:"pointer",backgroundColor:"grey.100"},whileHover:{scale:1.05},children:(0,H.jsx)("img",{src:"".concat(O.T,"/").concat(e),alt:"\u062a\u0635\u0648\u06cc\u0631 ".concat(t+1),style:{width:"100%",height:"100%",objectFit:"cover"}})},t)))})]})},Y=r.memo(G);var Z=i(71403),X=i(52607),$=i(4476),J=i(42400);const K=()=>{const e=[{icon:(0,H.jsx)(Z.A,{fontSize:"small"}),title:"\u0627\u0631\u0633\u0627\u0644 \u0633\u0631\u06cc\u0639",desc:"\u062a\u062d\u0648\u06cc\u0644 \u062f\u0631 24 \u0633\u0627\u0639\u062a"},{icon:(0,H.jsx)(X.A,{fontSize:"small"}),title:"\u06af\u0627\u0631\u0627\u0646\u062a\u06cc",desc:"18 \u0645\u0627\u0647 \u0636\u0645\u0627\u0646\u062a"},{icon:(0,H.jsx)($.A,{fontSize:"small"}),title:"\u067e\u0634\u062a\u06cc\u0628\u0627\u0646\u06cc",desc:"24/7"},{icon:(0,H.jsx)(J.A,{fontSize:"small"}),title:"\u067e\u0631\u062f\u0627\u062e\u062a",desc:"\u0627\u0645\u0646"}];return(0,H.jsx)(u.Ay,{container:!0,spacing:2,sx:{mt:3},children:e.map(((e,t)=>(0,H.jsx)(u.Ay,{item:!0,xs:6,sm:3,children:(0,H.jsxs)(p.A,{elevation:2,sx:{p:2,borderRadius:"12px",display:"flex",alignItems:"center",gap:2},children:[(0,H.jsx)(s.A,{sx:{color:"primary.main"},children:e.icon}),(0,H.jsxs)(s.A,{children:[(0,H.jsx)(A.A,{variant:"body2",fontWeight:"bold",children:e.title}),(0,H.jsx)(A.A,{variant:"caption",color:"text.secondary",children:e.desc})]})]})},t)))})},Q=r.memo(K);var U=i(83625),V=i(24056),ee=i(81045),te=i(39336),ie=i(78831);const ne=e=>{let{activeTab:t,onTabChange:i,product:n,reviews:r,rating:a,reviewText:o,onRatingChange:l,onReviewChange:c,onSubmitReview:x}=e;return(0,H.jsxs)(p.A,{elevation:0,sx:{borderRadius:"12px",overflow:"hidden",bgcolor:"background.default"},children:[(0,H.jsxs)(U.A,{value:t,onChange:(e,t)=>i(t),variant:"fullWidth",sx:{"& .MuiTabs-indicator":{backgroundColor:"primary.main",height:3},"& .MuiTab-root":{minWidth:"unset",fontWeight:600,"&.Mui-selected":{color:"primary.main"}}},children:[(0,H.jsx)(V.A,{label:"\u0645\u0634\u062e\u0635\u0627\u062a"}),(0,H.jsx)(V.A,{label:"\u0646\u0638\u0631\u0627\u062a"}),(0,H.jsx)(V.A,{label:"\u06af\u0627\u0631\u0627\u0646\u062a\u06cc"})]}),(0,H.jsxs)(s.A,{sx:{p:3},children:[0===t&&(0,H.jsx)(A.A,{variant:"body1",paragraph:!0,children:n.fullDescription||n.description}),1===t&&(0,H.jsxs)(s.A,{children:[r.length>0?r.map(((e,t)=>(0,H.jsxs)(s.A,{sx:{mb:3},children:[(0,H.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,H.jsx)(ee.A,{sx:{mr:2},children:e.user.charAt(0)}),(0,H.jsxs)(s.A,{children:[(0,H.jsx)(A.A,{variant:"subtitle1",children:e.user}),(0,H.jsxs)(s.A,{sx:{display:"flex",alignItems:"center"},children:[(0,H.jsx)(g.A,{value:e.rating,size:"small",readOnly:!0}),(0,H.jsx)(A.A,{variant:"caption",sx:{ml:1},children:new Date(e.date).toLocaleDateString("fa-IR")})]})]})]}),(0,H.jsx)(A.A,{variant:"body2",children:e.comment}),t<r.length-1&&(0,H.jsx)(te.A,{sx:{mt:2}})]},t))):(0,H.jsx)(A.A,{variant:"body2",color:"text.secondary",textAlign:"center",children:"\u0647\u0646\u0648\u0632 \u0646\u0638\u0631\u06cc \u062b\u0628\u062a \u0646\u0634\u062f\u0647 \u0627\u0633\u062a."}),(0,H.jsxs)(p.A,{elevation:0,sx:{p:3,mt:3,borderRadius:"12px"},children:[(0,H.jsx)(A.A,{variant:"h6",gutterBottom:!0,children:"\u0646\u0638\u0631 \u062e\u0648\u062f \u0631\u0627 \u062b\u0628\u062a \u06a9\u0646\u06cc\u062f"}),(0,H.jsx)(s.A,{sx:{mb:2},children:(0,H.jsx)(g.A,{value:a,onChange:(e,t)=>l(t),precision:.5,icon:(0,H.jsx)(q.A,{fontSize:"inherit"}),emptyIcon:(0,H.jsx)(z.A,{fontSize:"inherit"})})}),(0,H.jsx)(b.A,{fullWidth:!0,multiline:!0,rows:4,label:"\u0646\u0638\u0631 \u0634\u0645\u0627",value:o,onChange:c,sx:{mb:2}}),(0,H.jsx)(d.A,{variant:"contained",onClick:x,startIcon:(0,H.jsx)(ie.A,{}),fullWidth:!0,children:"\u062b\u0628\u062a \u0646\u0638\u0631"})]})]}),2===t&&(0,H.jsxs)(s.A,{children:[(0,H.jsx)(A.A,{variant:"h6",gutterBottom:!0,children:"\u06af\u0627\u0631\u0627\u0646\u062a\u06cc \u0648 \u0634\u0631\u0627\u06cc\u0637 \u0628\u0627\u0632\u06af\u0634\u062a"}),(0,H.jsx)(A.A,{variant:"body1",paragraph:!0,children:"\u0627\u06cc\u0646 \u0645\u062d\u0635\u0648\u0644 \u062f\u0627\u0631\u0627\u06cc 18 \u0645\u0627\u0647 \u06af\u0627\u0631\u0627\u0646\u062a\u06cc \u0634\u0631\u06a9\u062a\u06cc \u0645\u06cc\u200c\u0628\u0627\u0634\u062f. \u062f\u0631 \u0635\u0648\u0631\u062a \u0648\u062c\u0648\u062f \u0647\u0631\u06af\u0648\u0646\u0647 \u0645\u0634\u06a9\u0644 \u062f\u0631 \u0645\u062d\u0635\u0648\u0644\u060c \u0645\u06cc\u200c\u062a\u0648\u0627\u0646\u06cc\u062f \u062a\u0627 7 \u0631\u0648\u0632 \u067e\u0633 \u0627\u0632 \u062e\u0631\u06cc\u062f\u060c \u0645\u062d\u0635\u0648\u0644 \u0631\u0627 \u0645\u0631\u062c\u0648\u0639 \u0646\u0645\u0627\u06cc\u06cc\u062f."})]})]})]})},re=r.memo(ne),ae=async(e,t,i)=>{try{return(await O.A.post("views/add-view/".concat(e),{userId:t,productId:e},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)}})).data}catch(n){console.error("\u062e\u0637\u0627 \u062f\u0631 \u0648\u06cc\u0648 \u0645\u062d\u0635\u0648\u0644:",n)}};var oe=i(63197),se=i(34479);const le=async e=>{try{return(await O.A.get("/products/".concat(e,"/reviews"))).data}catch(t){throw console.error("Error fetching reviews:",t),t}},de=(0,F.A)(o.A)((e=>{let{theme:t}=e;return{paddingTop:t.spacing(4),paddingBottom:t.spacing(4)}})),ce=(0,F.A)(s.A)({display:"flex",alignItems:"center",gap:"16px",margin:"16px 0"}),xe=(0,F.A)(l.A)((e=>{let{theme:t}=e;return{backgroundColor:t.palette.error.light,color:t.palette.error.contrastText,fontWeight:"bold",padding:"4px 8px"}})),ue=(0,F.A)(d.A)((e=>{let{theme:t}=e;return{padding:"12px 24px",borderRadius:"8px",fontWeight:"600",transition:"all 0.3s ease","&:hover":{transform:"translateY(-2px)",boxShadow:t.shadows[4]}}}));function he(){const{productId:e}=(0,a.g)(),t=(0,a.Zp)(),i=(0,c.A)(),o=(0,x.A)(i.breakpoints.down("md")),[F,L]=(0,r.useState)({selectedProduct:null,relatedProducts:[],loading:!0,error:null,quantity:1,rating:0,review:"",reviews:[],activeTab:0,wishlisted:!1,currentImageIndex:0,loadingWishlist:!1,loadingAddToCart:!1}),[N,G]=(0,r.useState)({open:!1,message:"",severity:"info"}),Z=(0,r.useMemo)((()=>{var e,t;return null!==(e=F.selectedProduct)&&void 0!==e&&e.discount?Math.round(F.selectedProduct.price*(100-F.selectedProduct.discount)/100):null===(t=F.selectedProduct)||void 0===t?void 0:t.price}),[F.selectedProduct]),X=(0,r.useCallback)((async()=>{try{L((e=>(0,n.A)((0,n.A)({},e),{},{loading:!0,error:null})));const t=await(0,se.j0)(),i=t.find((t=>t._id===e));if(!i)return void L((e=>(0,n.A)((0,n.A)({},e),{},{error:"\u0645\u062d\u0635\u0648\u0644 \u0645\u0648\u0631\u062f \u0646\u0638\u0631 \u06cc\u0627\u0641\u062a \u0646\u0634\u062f."})));const[r]=await Promise.all([le(e).catch((()=>[])),ae(e).catch(console.error)]);L((a=>(0,n.A)((0,n.A)({},a),{},{selectedProduct:i,relatedProducts:t.filter((t=>t.category._id===i.category._id&&t._id!==e)).slice(0,4),reviews:r,rating:i.averageRating||0})))}catch(t){console.error("\u062e\u0637\u0627 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0645\u062d\u0635\u0648\u0644\u0627\u062a:",t),L((e=>(0,n.A)((0,n.A)({},e),{},{error:"\u062e\u0637\u0627 \u062f\u0631 \u0628\u0627\u0631\u06af\u0630\u0627\u0631\u06cc \u0645\u062d\u0635\u0648\u0644. \u0644\u0637\u0641\u0627\u064b \u062f\u0648\u0628\u0627\u0631\u0647 \u062a\u0644\u0627\u0634 \u06a9\u0646\u06cc\u062f."})))}finally{L((e=>(0,n.A)((0,n.A)({},e),{},{loading:!1})))}}),[e]);(0,r.useEffect)((()=>{X()}),[X]);const $=async()=>{const i=localStorage.getItem("token");if(!i)return J("\u0644\u0637\u0641\u0627\u064b \u0627\u0628\u062a\u062f\u0627 \u0648\u0627\u0631\u062f \u0634\u0648\u06cc\u062f","warning"),void t("/auth",{state:{from:"/product/".concat(e)}});try{L((e=>(0,n.A)((0,n.A)({},e),{},{loadingAddToCart:!0}))),await(0,oe.bE)(F.selectedProduct._id,F.quantity,i),J("\u0645\u062d\u0635\u0648\u0644 \u0628\u0647 \u0633\u0628\u062f \u062e\u0631\u06cc\u062f \u0627\u0636\u0627\u0641\u0647 \u0634\u062f","success")}catch(r){J("\u062e\u0637\u0627 \u062f\u0631 \u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0633\u0628\u062f \u062e\u0631\u06cc\u062f","error")}finally{L((e=>(0,n.A)((0,n.A)({},e),{},{loadingAddToCart:!1})))}},J=(e,t)=>{G({open:!0,message:e,severity:t})};return F.loading?(0,H.jsx)(de,{children:(0,H.jsxs)(u.Ay,{container:!0,spacing:4,children:[(0,H.jsxs)(u.Ay,{item:!0,xs:12,md:6,children:[(0,H.jsx)(h.A,{variant:"rectangular",width:"100%",height:400,sx:{borderRadius:2}}),(0,H.jsx)(s.A,{sx:{display:"flex",mt:2,gap:2},children:[0,1,2,3].map((e=>(0,H.jsx)(h.A,{variant:"rectangular",width:80,height:80,sx:{borderRadius:1}},e)))})]}),(0,H.jsxs)(u.Ay,{item:!0,xs:12,md:6,children:[(0,H.jsx)(h.A,{variant:"text",width:"60%",height:50}),(0,H.jsx)(h.A,{variant:"text",width:"40%",height:30,sx:{mb:2}}),(0,H.jsx)(h.A,{variant:"text",width:"100%",height:100}),(0,H.jsx)(h.A,{variant:"rounded",width:120,height:40,sx:{mt:2}})]})]})}):F.error?(0,H.jsxs)(de,{maxWidth:"lg",children:[(0,H.jsx)(m.A,{severity:"error",sx:{mb:3},children:F.error}),(0,H.jsx)(d.A,{variant:"outlined",startIcon:(0,H.jsx)(P.A,{}),onClick:()=>t(-1),sx:{borderRadius:"8px"},children:"\u0628\u0627\u0632\u06af\u0634\u062a"})]}):(0,H.jsxs)(de,{children:[(0,H.jsxs)(u.Ay,{container:!0,spacing:4,children:[(0,H.jsxs)(u.Ay,{item:!0,xs:12,md:6,children:[(0,H.jsx)(Y,{product:F.selectedProduct,currentImageIndex:F.currentImageIndex,onImageChange:e=>L((t=>(0,n.A)((0,n.A)({},t),{},{currentImageIndex:e}))),onWishlistToggle:async()=>{const i=localStorage.getItem("token");if(!i)return J("\u0644\u0637\u0641\u0627\u064b \u0627\u0628\u062a\u062f\u0627 \u0648\u0627\u0631\u062f \u0634\u0648\u06cc\u062f","warning"),void t("/auth",{state:{from:"/product/".concat(e)}});try{L((e=>(0,n.A)((0,n.A)({},e),{},{loadingWishlist:!0}))),await(0,se.pe)(F.selectedProduct._id,i),L((e=>(0,n.A)((0,n.A)({},e),{},{wishlisted:!e.wishlisted,loadingWishlist:!1}))),J(F.wishlisted?"\u0627\u0632 \u0644\u06cc\u0633\u062a \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627 \u062d\u0630\u0641 \u0634\u062f":"\u0628\u0647 \u0644\u06cc\u0633\u062a \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627 \u0627\u0636\u0627\u0641\u0647 \u0634\u062f","success")}catch(r){J("\u062e\u0637\u0627 \u062f\u0631 \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06cc \u0644\u06cc\u0633\u062a \u0639\u0644\u0627\u0642\u0647\u200c\u0645\u0646\u062f\u06cc\u200c\u0647\u0627","error"),L((e=>(0,n.A)((0,n.A)({},e),{},{loadingWishlist:!1})))}},wishlisted:F.wishlisted,loadingWishlist:F.loadingWishlist}),(0,H.jsx)(Q,{})]}),(0,H.jsxs)(u.Ay,{item:!0,xs:12,md:6,children:[(0,H.jsxs)(s.A,{sx:{mb:3},children:[(0,H.jsx)(A.A,{variant:"h4",component:"h1",gutterBottom:!0,fontWeight:"bold",children:F.selectedProduct.name}),(0,H.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,H.jsx)(l.A,{label:F.selectedProduct.category.name,color:"primary",size:"small",sx:{borderRadius:"4px"}}),(0,H.jsxs)(A.A,{variant:"caption",color:"text.secondary",children:["\u06a9\u062f: ",F.selectedProduct.sku||"\u0646\u062f\u0627\u0631\u062f"]})]}),(0,H.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:3},children:[(0,H.jsx)(g.A,{value:F.selectedProduct.averageRating||0,precision:.5,readOnly:!0,icon:(0,H.jsx)(q.A,{fontSize:"inherit",color:"primary"}),emptyIcon:(0,H.jsx)(z.A,{fontSize:"inherit"})}),(0,H.jsxs)(A.A,{variant:"body2",color:"text.secondary",children:["(",F.selectedProduct.reviewCount||0," \u0646\u0638\u0631)"]})]}),(0,H.jsxs)(ce,{children:[F.selectedProduct.discount>0&&(0,H.jsx)(xe,{label:"".concat(F.selectedProduct.discount,"% \u062a\u062e\u0641\u06cc\u0641")}),(0,H.jsxs)(s.A,{children:[F.selectedProduct.discount>0&&(0,H.jsxs)(A.A,{variant:"body1",color:"text.secondary",sx:{textDecoration:"line-through"},children:[F.selectedProduct.price.toLocaleString()," \u062a\u0648\u0645\u0627\u0646"]}),(0,H.jsxs)(A.A,{variant:"h4",color:"primary",fontWeight:"bold",children:[Z.toLocaleString()," \u062a\u0648\u0645\u0627\u0646"]})]})]}),(0,H.jsx)(A.A,{variant:"body1",color:"text.secondary",paragraph:!0,children:F.selectedProduct.shortDescription||F.selectedProduct.description}),(0,H.jsxs)(p.A,{elevation:0,sx:{p:3,mb:3,borderRadius:"12px",bgcolor:"background.default"},children:[(0,H.jsx)(A.A,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"\u062a\u0639\u062f\u0627\u062f:"}),(0,H.jsxs)(v.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,H.jsx)(j.A,{onClick:()=>L((e=>(0,n.A)((0,n.A)({},e),{},{quantity:Math.max(1,e.quantity-1)}))),disabled:F.quantity<=1,sx:{border:"1px solid ".concat(i.palette.divider),borderRadius:"8px"},children:(0,H.jsx)(S.A,{})}),(0,H.jsx)(b.A,{type:"number",value:F.quantity,onChange:e=>{const t=Math.max(1,parseInt(e.target.value)||1);L((e=>(0,n.A)((0,n.A)({},e),{},{quantity:t})))},sx:{width:80},inputProps:{min:1,style:{textAlign:"center"}}}),(0,H.jsx)(j.A,{onClick:()=>L((e=>(0,n.A)((0,n.A)({},e),{},{quantity:e.quantity+1}))),sx:{border:"1px solid ".concat(i.palette.divider),borderRadius:"8px"},children:(0,H.jsx)(W.A,{})})]})]}),(0,H.jsxs)(u.Ay,{container:!0,spacing:2,sx:{mb:3},children:[(0,H.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,H.jsx)(ue,{fullWidth:!0,variant:"contained",size:"large",startIcon:F.loadingAddToCart?(0,H.jsx)(y.A,{size:20,color:"inherit"}):(0,H.jsx)(T.A,{}),onClick:$,disabled:F.loadingAddToCart,children:F.loadingAddToCart?"\u062f\u0631 \u062d\u0627\u0644 \u0627\u0641\u0632\u0648\u062f\u0646...":"\u0627\u0641\u0632\u0648\u062f\u0646 \u0628\u0647 \u0633\u0628\u062f"})}),(0,H.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,H.jsx)(ue,{fullWidth:!0,variant:"outlined",size:"large",onClick:()=>{$(),t("/checkout")},children:"\u062e\u0631\u06cc\u062f \u0633\u0631\u06cc\u0639"})})]}),(0,H.jsxs)(p.A,{elevation:0,sx:{p:3,borderRadius:"12px",bgcolor:"background.default"},children:[(0,H.jsx)(A.A,{variant:"subtitle1",gutterBottom:!0,fontWeight:"bold",children:"\u0627\u0634\u062a\u0631\u0627\u06a9 \u06af\u0630\u0627\u0631\u06cc:"}),(0,H.jsx)(v.A,{direction:"row",spacing:1,justifyContent:"center",children:[{icon:(0,H.jsx)(R.A,{}),color:"#0088cc",name:"telegram"},{icon:(0,H.jsx)(D.A,{}),color:"#25D366",name:"whatsapp"},{icon:(0,H.jsx)(_.A,{}),color:"#E1306C",name:"instagram"},{icon:(0,H.jsx)(B.A,{}),color:"#1DA1F2",name:"twitter"}].map((e=>(0,H.jsx)(f.A,{title:"\u0627\u0634\u062a\u0631\u0627\u06a9 \u062f\u0631 ".concat(e.name),children:(0,H.jsx)(j.A,{sx:{color:e.color,backgroundColor:i.palette.action.hover,"&:hover":{backgroundColor:i.palette.action.selected}},children:e.icon})},e.name)))})]})]}),(0,H.jsx)(re,{activeTab:F.activeTab,onTabChange:e=>L((t=>(0,n.A)((0,n.A)({},t),{},{activeTab:e}))),product:F.selectedProduct,reviews:F.reviews,rating:F.rating,reviewText:F.review,onRatingChange:e=>L((t=>(0,n.A)((0,n.A)({},t),{},{rating:e}))),onReviewChange:e=>L((t=>(0,n.A)((0,n.A)({},t),{},{review:e.target.value}))),onSubmitReview:async()=>{if(!F.review||0===F.rating)return void J("\u0644\u0637\u0641\u0627\u064b \u0627\u0645\u062a\u06cc\u0627\u0632 \u0648 \u0646\u0638\u0631 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f","warning");const i=localStorage.getItem("token");if(!i)return J("\u0644\u0637\u0641\u0627\u064b \u0627\u0628\u062a\u062f\u0627 \u0648\u0627\u0631\u062f \u0634\u0648\u06cc\u062f","warning"),void t("/auth",{state:{from:"/product/".concat(e)}});try{const t=await(async(e,t,i)=>{try{return(await O.A.post("/products/".concat(e,"/reviews"),t,{headers:{Authorization:"Bearer ".concat(i)}})).data}catch(n){throw console.error("Error submitting review:",n),n}})(e,{rating:F.rating,comment:F.review},i),r=[...F.reviews,t],a=r.reduce(((e,t)=>e+t.rating),0)/r.length;L((e=>(0,n.A)((0,n.A)({},e),{},{reviews:r,review:"",rating:0,selectedProduct:(0,n.A)((0,n.A)({},e.selectedProduct),{},{averageRating:a,reviewCount:r.length})}))),J("\u0646\u0638\u0631 \u0634\u0645\u0627 \u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u062b\u0628\u062a \u0634\u062f","success")}catch(r){J("\u062e\u0637\u0627 \u062f\u0631 \u062b\u0628\u062a \u0646\u0638\u0631","error")}}})]})]}),F.relatedProducts.length>0&&(0,H.jsxs)(s.A,{sx:{mt:8},children:[(0,H.jsx)(A.A,{variant:"h5",gutterBottom:!0,fontWeight:"bold",children:"\u0645\u062d\u0635\u0648\u0644\u0627\u062a \u0645\u0634\u0627\u0628\u0647"}),(0,H.jsx)(u.Ay,{container:!0,spacing:3,children:F.relatedProducts.map((e=>(0,H.jsx)(u.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,H.jsx)(M.P.div,{whileHover:{y:-5},initial:{opacity:0},animate:{opacity:1},children:(0,H.jsx)(E.A,{product:e})})},e._id)))})]}),o&&(0,H.jsx)(w.A,{color:"primary",sx:{position:"fixed",bottom:24,right:24,zIndex:1e3},onClick:$,disabled:F.loadingAddToCart,children:F.loadingAddToCart?(0,H.jsx)(y.A,{size:24,color:"inherit"}):(0,H.jsx)(C.A,{badgeContent:F.quantity,color:"secondary",children:(0,H.jsx)(T.A,{})})}),(0,H.jsx)(k.A,{open:N.open,autoHideDuration:3e3,onClose:()=>G((e=>(0,n.A)((0,n.A)({},e),{},{open:!1}))),anchorOrigin:{vertical:"bottom",horizontal:"left"},TransitionComponent:I.A,children:(0,H.jsx)(m.A,{severity:N.severity,sx:{width:"100%"},onClose:()=>G((e=>(0,n.A)((0,n.A)({},e),{},{open:!1}))),children:N.message})})]})}const me=r.memo(he)}}]);
//# sourceMappingURL=711.fd2ea98c.chunk.js.map