"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[761],{68831:(e,t,i)=>{i.d(t,{N:()=>l});var n,s=i(57528);const l=i(1529).Ay.div(n||(n=(0,s.A)(["\n  width: 100%;\n  display: grid;\n  align-items:flex-start;\n  justify-content:center;\n  margin:0;\n  height: calc(100dvh - 10px);\n  padding-bottom:150px;\n  z-index:1001;\n  @media (max-width: 768px) {\n    height: calc(100dvh - 100px);\n\n  }\n\n"])))},87154:(e,t,i)=>{i.r(t),i.d(t,{default:()=>R});var n=i(89379),s=i(65043),l=i(26240),r=i(54552),a=i(30815),c=i(43845),o=i(24010),d=i(94496),x=i(61596),u=i(17392),p=i(30279),h=i(69413),g=i(74605),m=i(51962),A=i(39336),f=i(11906),b=i(53193),j=i(78492),v=i(16374),C=i(72040),y=i(78185),w=i(20746),k=i(33438),F=i(71434),_=(i(92279),i(11585),i(20326)),S=i(6058),I=i(17304),E=i(68831),B=i(83003),N=i(34483),z=i(71621),D=i(70579);function R(){const e=(0,l.A)(),[t,i]=(0,s.useState)([{subCategories:[1,2,3,4]},{subCategories:[1,2,3,4]},{subCategories:[1,2,3,4]},{subCategories:[1,2,3,4]},{subCategories:[1,2,3,4]}]),[I,R]=(0,s.useState)([]),[W,M]=(0,s.useState)([]),[Y,q]=(0,s.useState)([]),[L,P]=(0,s.useState)([]),[T,U]=(0,s.useState)([]),[$,G]=(0,s.useState)(""),H=(0,r.A)(e.breakpoints.down("sm")),[J,K]=(0,s.useState)(!1),[O,Q]=(0,s.useState)(null),{products:V,loading:X}=(0,B.d4)((e=>e.products)),Z=(0,B.d4)(z.Y9),ee=(0,B.d4)(N.selectAllSubcategories);(0,s.useEffect)((()=>{(async()=>{try{i(Z);const e=null===ee||void 0===ee?void 0:ee.map((e=>{const t=Z.find((t=>{var i;return null===(i=t.subCategories)||void 0===i?void 0:i.some((t=>t._id===e._id))}));return{_id:e._id,name:e.name,categoryId:null===t||void 0===t?void 0:t._id,categoryName:null===t||void 0===t?void 0:t.name}}));R(e);const t=V.map((e=>e.price)).filter((e=>e>0)).sort(((e,t)=>e-t));if(0===t.length){return void P([{id:"bucket-0",start:0,end:1e5,count:0,label:"\u062a\u0627 \u06f1\u06f0\u06f0 \u0647\u0632\u0627\u0631 \u062a\u0648\u0645\u0627\u0646"},{id:"bucket-1",start:1e5,end:5e5,count:0,label:"\u06f1\u06f0\u06f0 \u062a\u0627 \u06f5\u06f0\u06f0 \u0647\u0632\u0627\u0631 \u062a\u0648\u0645\u0627\u0646"},{id:"bucket-2",start:5e5,end:1e6,count:0,label:"\u06f5\u06f0\u06f0 \u0647\u0632\u0627\u0631 \u062a\u0627 \u06f1 \u0645\u06cc\u0644\u06cc\u0648\u0646 \u062a\u0648\u0645\u0627\u0646"},{id:"bucket-3",start:1e6,end:2e6,count:0,label:"\u06f1 \u062a\u0627 \u06f2 \u0645\u06cc\u0644\u06cc\u0648\u0646 \u062a\u0648\u0645\u0627\u0646"},{id:"bucket-4",start:2e6,end:5e6,count:0,label:"\u0628\u06cc\u0634 \u0627\u0632 \u06f2 \u0645\u06cc\u0644\u06cc\u0648\u0646 \u062a\u0648\u0645\u0627\u0646"}])}Math.floor(t[0]);const n=Math.ceil(t[t.length-1]),s=[{min:0,max:1e6},{min:1e6,max:5e6},{min:5e6,max:2e7},{min:2e7,max:5e7},{min:5e7,max:1/0}].map(((e,t)=>{const i=V.filter((t=>t.price&&t.price>=e.min&&t.price<=e.max));let s="";return s=e.max===1/0?"\u0628\u06cc\u0634 \u0627\u0632 ".concat((e.min/1e6).toFixed(0)," \u0645\u06cc\u0644\u06cc\u0648\u0646 \u062a\u0648\u0645\u0627\u0646"):e.max>=1e6?"".concat((e.min/1e6).toFixed(0)," \u062a\u0627 ").concat((e.max/1e6).toFixed(0)," \u0645\u06cc\u0644\u06cc\u0648\u0646 \u062a\u0648\u0645\u0627\u0646"):e.max>=1e3?"".concat((e.min/1e3).toFixed(0)," \u062a\u0627 ").concat((e.max/1e3).toFixed(0)," \u0647\u0632\u0627\u0631 \u062a\u0648\u0645\u0627\u0646"):"\u062a\u0627 ".concat(e.max.toLocaleString()," \u062a\u0648\u0645\u0627\u0646"),{id:"bucket-".concat(t),start:e.min,end:e.max===1/0?n:e.max,count:i.length,label:s}}));P(s)}catch(e){console.error("Error loading data:",e)}})()}),[ee]);const te={labels:L.map((e=>e.label)),datasets:[{data:L.map((e=>e.count)),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#8AC24A","#F06292","#7986CB","#4DB6AC"],hoverBackgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#8AC24A","#F06292","#7986CB","#4DB6AC"],borderWidth:1}]},ie=e=>{if(M((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e])),W.includes(e)){const t=I.filter((t=>t.categoryId===e)).map((e=>e._id));q((e=>e.filter((e=>!t.includes(e)))))}},ne=e=>{if(q((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e])),!Y.includes(e)){const t=I.find((t=>t._id===e));t&&!W.includes(t.categoryId)&&M((e=>[...e,t.categoryId]))}},se=e=>{U((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},le=e=>{Q(O===e?null:e)};(0,s.useEffect)((()=>{H||K(!0)}),[H]);const re=I.reduce(((e,t)=>{const i=V.filter((e=>{var i;return(null===(i=e.subCategory)||void 0===i?void 0:i._id)===t._id})).length;return(0,n.A)((0,n.A)({},e),{},{[t._id]:i})}),{}),ae=V.filter((e=>{var t;if(W.length>0&&!W.includes(null===(t=e.category)||void 0===t?void 0:t._id))return!1;if(Y.length>0&&(!e.subCategory||!Y.includes(e.subCategory._id)))return!1;if(T.length>0&&e.price){if(!T.some((t=>{const i=L.find((e=>e.id===t));return e.price>=i.start&&e.price<=i.end})))return!1}return!0})).sort(((e,t)=>{var i,n,s,l;return"likes"===$?((null===(i=t.likes)||void 0===i?void 0:i.length)||0)-((null===(n=e.likes)||void 0===n?void 0:n.length)||0):"views"===$?((null===(s=t.viewers)||void 0===s?void 0:s.length)||0)-((null===(l=e.viewers)||void 0===l?void 0:l.length)||0):"price"===$||"price-low"===$?(e.price||0)-(t.price||0):"price-high"===$?(t.price||0)-(e.price||0):"newest"===$?new Date(t.createdAt||0)-new Date(e.createdAt||0):0}));return(0,D.jsxs)(E.N,{className:"scroller",children:[(0,D.jsx)(F.U,{className:"horcat"}),(0,D.jsxs)(a.A,{sx:{display:"flex",gap:2,padding:"5px 10px",flexWrap:"wrap"},children:[W.map((e=>{const i=t.find((t=>t._id===e));return(0,D.jsx)(c.A,{label:null===i||void 0===i?void 0:i.name,onDelete:()=>ie(e),sx:{color:"white",p:1}},e)})),Y.map((e=>{const t=I.find((t=>t._id===e));return(0,D.jsx)(c.A,{label:"".concat(null===t||void 0===t?void 0:t.categoryName," - ").concat(null===t||void 0===t?void 0:t.name),onDelete:()=>ne(e),sx:{background:"#393E46",color:"white",p:1}},e)})),T.map((e=>{const t=L.find((t=>t.id===e));return(0,D.jsx)(c.A,{label:null===t||void 0===t?void 0:t.label,onDelete:()=>se(e),sx:{background:"#393E46",color:"white",p:1}},e)}))]}),!J&&(0,D.jsxs)(o.A,{"aria-label":"filter",sx:{position:"fixed",bottom:H?"80px":"30px",right:"20px",zIndex:1005,background:"#393E46",boxShadow:0,padding:"2px 10px",borderRadius:"5px",height:"35px",width:"max-content",display:"flex",alignItems:"center",gap:"5px"},onClick:()=>K(!0),children:[(0,D.jsx)(w.A,{fontSize:"small",sx:{color:"#fff"}}),(0,D.jsx)(d.A,{variant:"p",sx:{color:"#fff"},children:"\u0641\u06cc\u0644\u062a\u0631\u0647\u0627"})]}),(0,D.jsxs)(x.A,{className:"filter",sx:{position:"fixed",zIndex:1005,width:H?"100vw":"300px",height:H?"70vh":"100vh",right:H||J?0:-300,bottom:H?J?0:-1e3:0,transition:"all 0.2s ease-in",overflowY:"auto"},children:[(0,D.jsxs)(a.A,{sx:{p:1,background:" #393E46",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,D.jsx)(d.A,{variant:"h6",children:"\u0641\u06cc\u0644\u062a\u0631\u0647\u0627"}),(0,D.jsx)(u.A,{color:"inherit",onClick:()=>K(!1),children:(0,D.jsx)(k.A,{})})]}),(0,D.jsxs)(a.A,{sx:{p:2},children:[(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>le("categories"),children:[(0,D.jsx)(d.A,{variant:"subtitle1",children:"\u062f\u0633\u062a\u0647\u200c\u0628\u0646\u062f\u06cc\u200c\u0647\u0627"}),(0,D.jsx)(d.A,{children:"categories"===O?"\u2212":"+"})]}),(0,D.jsx)(p.A,{in:"categories"===O||!H,children:(0,D.jsx)(h.A,{sx:{mt:1},children:t.map((e=>{const t=V.filter((t=>{var i;return(null===(i=t.category)||void 0===i?void 0:i._id)===e._id})).length;return(0,D.jsx)(g.A,{control:(0,D.jsx)(m.A,{checked:W.includes(e._id),onChange:()=>ie(e._id)}),label:"".concat(e.name," (").concat(t,")")},e._id)}))})})]}),(0,D.jsxs)(a.A,{sx:{p:2},children:[(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>le("subcategories"),children:[(0,D.jsx)(d.A,{variant:"subtitle1",children:"\u0632\u06cc\u0631\u062f\u0633\u062a\u0647\u200c\u0647\u0627"}),(0,D.jsx)(d.A,{children:"subcategories"===O?"\u2212":"+"})]}),(0,D.jsx)(p.A,{in:"subcategories"===O||!H,children:(0,D.jsx)(h.A,{sx:{mt:1},children:I.filter((e=>0===W.length||W.includes(e.categoryId))).map((e=>(0,D.jsx)(g.A,{control:(0,D.jsx)(m.A,{checked:Y.includes(e._id),onChange:()=>ne(e._id),disabled:0===re[e._id]}),label:e.name||"\u0628\u062f\u0648\u0646 \u0632\u06cc\u0631 \u062f\u0633\u062a\u0647 ",sx:{opacity:0===re[e._id]?.5:1,ml:2}},e._id)))})})]}),(0,D.jsx)(A.A,{}),(0,D.jsxs)(a.A,{sx:{p:2},children:[(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>le("price"),children:[(0,D.jsx)(d.A,{variant:"subtitle1",children:"\u062a\u0648\u0632\u06cc\u0639 \u0642\u06cc\u0645\u062a\u200c\u0647\u0627"}),(0,D.jsx)(d.A,{children:"price"===O?"\u2212":"+"})]}),(0,D.jsx)(p.A,{in:"price"===O||!H,children:(0,D.jsxs)(a.A,{sx:{mt:2},children:[(0,D.jsx)(d.A,{variant:"body2",sx:{mb:1},children:T.length>0?"".concat(T.length," \u0645\u062d\u062f\u0648\u062f\u0647 \u0627\u0646\u062a\u062e\u0627\u0628 \u0634\u062f\u0647"):"\u0628\u0631\u0627\u06cc \u0627\u0646\u062a\u062e\u0627\u0628 \u0645\u062d\u062f\u0648\u062f\u0647 \u0642\u06cc\u0645\u062a \u0631\u0648\u06cc \u0628\u062e\u0634\u200c\u0647\u0627\u06cc \u0646\u0645\u0648\u062f\u0627\u0631 \u06a9\u0644\u06cc\u06a9 \u06a9\u0646\u06cc\u062f"}),(0,D.jsx)(a.A,{sx:{height:"300px",position:"relative",mb:2},children:(0,D.jsx)(S.Fq,{data:te,options:{onClick:(e,t)=>{if(t.length>0){const e=t[0].index,i=L[e].id;se(i)}},plugins:{tooltip:{callbacks:{label:e=>{const t=e.label||"",i=e.raw||0,n=Math.round(i/V.length*100);return"".concat(t,": ").concat(i," \u0645\u062d\u0635\u0648\u0644 (").concat(n,"%)")}}},legend:{position:"bottom",rtl:!0,labels:{usePointStyle:!0,boxWidth:10,padding:20,font:{family:"IRANSans",size:H?10:12}}}},maintainAspectRatio:!1}})}),T.length>0&&(0,D.jsx)(f.A,{fullWidth:!0,variant:"outlined",color:"error",onClick:()=>U([]),sx:{mt:2},children:"\u062d\u0630\u0641 \u0627\u0646\u062a\u062e\u0627\u0628\u200c\u0647\u0627"})]})})]}),(0,D.jsx)(A.A,{}),(0,D.jsxs)(a.A,{sx:{p:2},children:[(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>le("sort"),children:[(0,D.jsx)(d.A,{variant:"subtitle1",children:"\u0645\u0631\u062a\u0628\u200c\u0633\u0627\u0632\u06cc"}),(0,D.jsx)(d.A,{children:"sort"===O?"\u2212":"+"})]}),(0,D.jsx)(p.A,{in:"sort"===O||!H,children:(0,D.jsx)(b.A,{component:"fieldset",sx:{mt:1},children:(0,D.jsxs)(j.A,{value:$,onChange:e=>G(e.target.value),children:[(0,D.jsx)(g.A,{value:"likes",control:(0,D.jsx)(v.A,{}),label:"\u0645\u062d\u0628\u0648\u0628\u200c\u062a\u0631\u06cc\u0646"}),(0,D.jsx)(g.A,{value:"views",control:(0,D.jsx)(v.A,{}),label:"\u067e\u0631\u0628\u0627\u0632\u062f\u06cc\u062f\u062a\u0631\u06cc\u0646"}),(0,D.jsx)(g.A,{value:"price-low",control:(0,D.jsx)(v.A,{}),label:"\u0627\u0631\u0632\u0627\u0646\u200c\u062a\u0631\u06cc\u0646"}),(0,D.jsx)(g.A,{value:"price-high",control:(0,D.jsx)(v.A,{}),label:"\u06af\u0631\u0627\u0646\u200c\u062a\u0631\u06cc\u0646"}),(0,D.jsx)(g.A,{value:"newest",control:(0,D.jsx)(v.A,{}),label:"\u062c\u062f\u06cc\u062f\u062a\u0631\u06cc\u0646"})]})})})]})]}),(0,D.jsx)(a.A,{sx:{width:"100vw",display:"grid",gridTemplateColumns:H?"1fr 1fr":"repeat(auto-fill, minmax(250px, 1fr))",gap:1,p:2,pr:!H&&J?"320px":2,transition:"padding 0.3s ease"},children:X?Array(12).fill().map(((e,t)=>(0,D.jsxs)(C.A,{spacing:1,className:"Card",sx:{bgcolor:"#ffffff10",padding:"5px",width:"260px"},children:[(0,D.jsx)(y.A,{variant:"rectangular",height:200,sx:{borderRadius:"2px",bgcolor:"#cccccc50"}}),(0,D.jsx)(y.A,{variant:"text",sx:{fontSize:"1rem",bgcolor:"#cccccc50",borderRadius:"2px"}}),(0,D.jsx)(y.A,{variant:"text",width:"60%",sx:{fontSize:"1rem",bgcolor:"#cccccc50",borderRadius:"2px"}})]},t))):0===ae.length?(0,D.jsxs)(a.A,{sx:{gridColumn:"1 / -1",textAlign:"center",py:4},children:[(0,D.jsx)(d.A,{variant:"h6",children:"\u0645\u062d\u0635\u0648\u0644\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f"}),(0,D.jsx)(f.A,{variant:"outlined",sx:{mt:2},onClick:()=>{M([]),q([]),U([]),G("")},children:"\u062d\u0630\u0641 \u0647\u0645\u0647 \u0641\u06cc\u0644\u062a\u0631\u0647\u0627"})]}):ae.map((e=>(0,D.jsx)(_.A,{product:e})))})]})}I.t1.register(I.Bs,I.m_,I.s$)}}]);
//# sourceMappingURL=761.b1eb51bd.chunk.js.map